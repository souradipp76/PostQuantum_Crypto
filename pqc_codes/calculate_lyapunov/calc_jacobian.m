function J= calc_jacobian()
    syms x1 x2 x3 x4 x5 x6
    
    m1=0.2944;m2=0.1765;m3=0.0947;
    L1=0.508;L2=0.254;L3=0.127;
    k1=0.005;k2=0;k3=0.0008;
    I1=9.526e-3;I2=1.625e-3;I3=1.848e-4;
    g=9.81;
    
    f1 = x4;
    f2 = x5;
    f3 = x6;
    f4 = -(2*(((L3^2)*(m3^2)*sin(2*x1-2*x3)*(4*I2-(L2^2)*m2)+(L2^2)*sin(2*x1-2*x2)*(m2 + 2*m3)*(m2*m3*(L3^2)+4*I3*(m2 + 2*m3)))*(L1^2)*(x4^2) +(L2*(sin(x1- x2)*((m2*m3*(m2 + 3*m3)*(L3^2)+ 4*I3*((m2^2)+ 6*m2*m3 + 8*(m3^2)))*(L2^2)+4*I2*(m3*(m2 +m3)*(L3^2) + 4*I3*(m2 + 2*m3)))+(L3^2)*(m3^2)*sin(x1 + x2 -2*x3)*(4*I2-(L2^2)*m2))*(x5^2)- 4*k2*L2*(cos(x1-x2)*(m3*(m2 +m3)*(L3^2)+4*I3*(m2+2*m3))- (L3^2)*(m3^2)*cos(x1+x2-2*x3))*(x5^2)+ L3*m3*(sin(x1-x3)*(8*I3*m3*(L2^2)+4*I2*m3*(L3^2)+16*I2*I3)+ (L2^2)*sin(x1-2*x2 +x3)*(m2*m3*(L3^2) +4*I3*(m2 +2*m3)))*(x6^2)- 4*k3*L3*m3*(cos(x1-x3)*(2*m3*(L2^2) +4*I2)- (L2^2)*cos(x1-2*x2 + x3)*(m2 + 2*m3))*x6- g*(sin(x1)*((m3*(m1*m2 + 2*m1*m3 + 3*m2*m3 + (m2^2))*(L3^2) + 4*I3*((m2^2)+ 6*m2*m3 + m1*m2 + 4*(m3^2)+ 4*m1*m3))*(L2^2)+ 4*I2*(m3*(m1 + 2*m2 + m3)*(L3^2) + 4*I3*(m1 + 2*m2 + 2*m3)))+ (L3^2)*(m3^2)*(sin(x1-2*x3)*(4*I2-(L2^2)*m2)- 2*(L2^2)*cos(2*x2-2*x3)*sin(x1)*(m1 + m2))+ (L2^2)*sin(x1-2*x2)*(m2 + 2*m3)*(m2*m3*(L3^2) +4*I3*(m2+2*m3))))*L1+ 2*k1*(4*I2*(m3*(L3^2) + 4*I3)+(L2^2)*(m3*(m2+2*m3)*(L3^2) + 4*I3*(m2+4*m3))-2*(L2^2)*(L3^2)*(m3^2)*cos(2*x2-2*x3))*x1))/(64*I1*I2*I3 +8*I3*(L1^2)*(L2^2)*(m2^2)+8*I1*(L2^2)*(L3^2)*(m3^2)+8*I2*(L1^2)*(L3^2)*(m3^2)+32*I3*(L1^2)*(L2^2)*(m3^2)+ 16*I2*I3*(L1^2)*m1 +16*I1*I3*(L2^2)*m2 +64*I2*I3*(L1^2)*m2+16*I1*I2*(L3^2)*m3+ 64*I1*I3*(L2^2)*m3 +64*I2*I3*(L1^2)*m3+4*I3*(L1^2)*(L2^2)*m1*m2+4*I2*(L1^2)*(L3^2)*m1*m3+ 16*I3*(L1^2)*(L2^2)*m1*m3+4*I1*(L2^2)*(L3^2)*m2*m3 +16*I2*(L1^2)*(L3^2)*m2*m3 +48*I3*(L1^2)*(L2^2)*m2*m3- 8*I1*(L2^2)*(L3^2)*(m3^2)*cos(2*x2-2*x3)- 2*(L1^2)*(L2^2)*cos(2*x1-2*x2)*(m2 +2*m3)*(m2*m3*(L3^2)+4*I3*(m2+2*m3))- 2*(L1^2)*(L3^2)*(m3^2)*cos(2*x1-2*x3)*(-m2*(L2^2)+4*I2)+2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2) + 6*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2) + 2*(L1^2)*(L2^2)*(L3^2)*(m2^2)*m3+ (L1^2)*(L2^2)*(L3^2)*m1*m2*m3 - 2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)*cos(2*x2-2*x3)- 4*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*cos(2*x2-2*x3));
    f5 = (2*(((L1^2)*sin(2*x1 - 2*x2)*(m2 + 2*m3)*(m2*m3*(L3^2) + 4*I3*(m2 + 2*m3))- (L3^2)*(m3^2)*sin(2*x2 - 2*x3)*((m1 +2*m2)*(L1^2) +4*I1))*(L2^2)*(x5^2) + L1*(sin(x1 -x2)*((m3*(m1*(m2 +m3)+2*m2*(2*m2 +3*m3))*(L3^2)+4*I3*(m2 +2*m3)*(m1 +4*m2 + 4*m3))*(L1^2) + 4*I1*(m3*(m2 + m3)*(L3^2) + 4*I3*(m2 + 2*m3)))-(L3^2)*(m3^2)*sin(x1 + x2 - 2*x3)*((m1 + 2*m2)*(L1^2) + 4*I1))*L2*(x4^2)+4*k1*L1*(cos(x1 - x2)*(m3*(m2 + m3)*(L3^2) + 4*I3*(m2 + 2*m3))-(L3^2)*(m3^2)*cos(x1 + x2 - 2*x3))*L2*x4 +(-L3*m3*(sin(x2-x3)*((m3*(m1+3*m2)*(L3^2)+ 4*I3*(m1+3*m2+2*m3))*(L1^2)+4*I1*(m3*(L3^2)+4*I3))-(L1^2)*sin(2*x1-x2-x3)*(m2*m3*(L3^2) +4*I3*(m2 +2*m3)))*(x6^2)+ 4*k3*L3*m3*(cos(x2 -x3)*((m1 +3*m2 +2*m3)*(L1^2) +4*I1)- (L1^2)*cos(2*x1 -x2-x3)*(m2+2*m3))*x6+ g*(sin(x2)*((m2*m3*(2*m2+3*m3)*(L3^2)+ 8*I3*((m2^2)+3*m2*m3+2*(m3^2)))*(L1^2) + 4*I1*(m3*(m2+m3)*(L3^2) +4*I3*(m2 + 2*m3)))- (L1^2)*sin(2*x1 - x2)*(m3*(m1*(m2 + m3) + m2*(2*m2 + 3*m3))*(L3^2)+ 4*I3*(m2 +2*m3)*(m1 + 2*m2 + 2*m3)) + (L3^2)*(m3^2)*(sin(x2 - 2*x3)*(m2*(L1^2) + 4*I1)+ (L1^2)*sin(2*x1 + x2 - 2*x3)*(m1 +m2))))*L2- 2*k2*(4*I1*(m3*(L3^2) + 4*I3) + (L1^2)*(m3*(m1 + 4*m2 + 2*m3)*(L3^2)+ 4*I3*(m1 + 4*m2 + 4*m3)) - 2*(L1^2)*(L3^2)*(m3^2)*cos(2*x1 -2*x3))*(x5^2)))/(64*I1*I2*I3 +8*I3*(L1^2)*(L2^2)*(m2^2)+8*I1*(L2^2)*(L3^2)*(m3^2)+8*I2*(L1^2)*(L3^2)*(m3^2)+32*I3*(L1^2)*(L2^2)*(m3^2)+16*I2*I3*(L1^2)*m1 + 16*I1*I3*(L2^2)*m2 +64*I2*I3*(L1^2)*m2+ 16*I1*I2*(L3^2)*m3+64*I1*I3*(L2^2)*m3+64*I2*I3*(L1^2)*m3+4*I3*(L1^2)*(L2^2)*m1*m2+ 4*I2*(L1^2)*(L3^2)*m1*m3+16*I3*(L1^2)*(L2^2)*m1*m3+4*I1*(L2^2)*(L3^2)*m2*m3+ 16*I2*(L1^2)*(L3^2)*m2*m3 +48*I3*(L1^2)*(L2^2)*m2*m3 -8*I1*(L2^2)*(L3^2)*(m3^2)*cos(2*x2 -2*x3)- 2*(L1^2)*(L2^2)*cos(2*x1 -2*x2)*(m2 +2*m3)*(m2*m3*(L3^2)+4*I3*(m2+2*m3))- 2*(L1^2)*(L3^2)*(m3^2)*cos(2*x1-2*x3)*(-m2*(L2^2)+4*I2)+2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)+ 6*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)+2*(L1^2)*(L2^2)*(L3^2)*(m2^2)*m3 + (L1^2)*(L2^2)*(L3^2)*m1*m2*m3- 2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)*cos(2*x2 - 2*x3) - 4*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*cos(2*x2 - 2*x3));
    f6 = -(2*(32*I1*I2*k3*x6 - L2*L3*m3*(x5^2)*(sin(x2 - x3)*(((L2^2)*(m1*m2 + 4*m1*m3 + 6*m2*m3 + (m2^2))+ 4*I2*(m1 +3*m2 + 2*m3))*(L1^2) + 4*I1*(4*I2 + (L2^2)*(m2 + 4*m3)))+ (L1^2)*sin(2*x1 - x2 - x3)*(m2 + 2*m3)*(4*I2 - m2*(L2^2)))- L1*L3*m3*(x4^2)*(sin(x1 -x3)*(8*I1*(m3*(L2^2) +2*I2)+2*(L1^2)*((m1*m3 -(m2^2))*(L2^2)+ 2*I2*(m1 +4*m2 +4*m3)))- (L2^2)*sin(x1 -2*x2 + x3)*(m2 + 2*m3)*((m1 + 2*m2)*(L1^2) + 4*I1))+ 4*k3*(L1^2)*(L2^2)*(m2^2)*x6 + 16*k3*(L1^2)*(L2^2)*(m3^2)*x6 + 8*I2*k3*(L1^2)*m1*x6+ 8*I1*k3*(L2^2)*m2*x6 + 32*I2*k3*(L1^2)*m2*x6 + 32*I1*k3*(L2^2)*m3*x6+ 32*I2*k3*(L1^2)*m3*x6 - 4*k1*L1*L3*m3*x4*(cos(x1 - x3)*(2*m3*(L2^2) +4*I2)- (L2^2)*cos(x1 - 2*x2 + x3)*(m2 + 2*m3)) - 16*I1*I2*g*L3*m3*sin(x3)- 4*I2*(L1^2)*(L3^2)*(m3^2)*(x6^2)*sin(2*x1 - 2*x3) -4*I1*(L2^2)*(L3^2)*(m3^2)*(x6^2)*sin(2*x2 -2*x3)+ 8*I2*g*(L1^2)*L3*(m3^2)*sin(2*x1 -x3)+8*I1*g*(L2^2)*L3*(m3^2)*sin(2*x2 -x3)+ 2*k3*(L1^2)*(L2^2)*m1*m2*x6 + 8*k3*(L1^2)*(L2^2)*m1*m3*x6 + 24*k3*(L1^2)*(L2^2)*m2*m3*x6- 4*k2*L2*L3*m3*x5*(cos(x2 - x3)*((m1 + 3*m2 + 2*m3)*(L1^2) + 4*I1)- (L1^2)*cos(2*x1 - x2 - x3)*(m2 + 2*m3)) - 8*I1*g*(L2^2)*L3*(m3^2)*sin(x3)- 8*I2*g*(L1^2)*L3*(m3^2)*sin(x3) - 4*k3*(L1^2)*(L2^2)*(m2^2)*x6*cos(2*x1 -2*x2)- 16*k3*(L1^2)*(L2^2)*(m3^2)*x6*cos(2*x1 - 2*x2) - 8*I2*g*(L1^2)*L3*m2*m3*sin(x3)- 16*k3*(L1^2)*(L2^2)*m2*m3*x6*cos(2*x1 - 2*x2) -(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)*(x6^2)*sin(2*x2 - 2*x3)+ (L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*(x6^2)*sin(2*x1 - 2*x3) - 2*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*(x6^2)*sin(2*x2 -2*x3)+ 2*g*(L1^2)*(L2^2)*L3*m1*(m3^2)*sin(2*x1 - x3) - g*(L1^2)*(L2^2)*L3*(m2^2)*m3*sin(2*x1 - x3)+ 2*g*(L1^2)*(L2^2)*L3*m2*(m3^2)*sin(2*x2 -x3) + g*(L1^2)*(L2^2)*L3*(m2^2)*m3*sin(2*x2 - x3)+ 4*I2*g*(L1^2)*L3*m1*m3*sin(2*x1 - x3) + 8*I2*g*(L1^2)*L3*m2*m3*sin(2*x1 - x3)+ 4*I1*g*(L2^2)*L3*m2*m3*sin(2*x2 - x3) - 2*g*(L1^2)*(L2^2)*L3*m1*(m3^2)*sin(2*x1 - 2*x2 + x3)- 2*g*(L1^2)*(L2^2)*L3*m2*(m3^2)*sin(2*x1 - 2*x2 +x3) - g*(L1^2)*(L2^2)*L3*(m2^2)*m3*sin(2*x1 - 2*x2 + x3)+ g*(L1^2)*(L2^2)*L3*(m2^2)*m3*sin(x3) - g*(L1^2)*(L2^2)*L3*m1*m2*m3*sin(2*x1 - 2*x2 +x3)))/(64*I1*I2*I3 + 8*I3*(L1^2)*(L2^2)*(m2^2)+ 8*I1*(L2^2)*(L3^2)*(m3^2)*+ 8*I2*(L1^2)*(L3^2)*(m3^2)+ 32*I3*(L1^2)*(L2^2)*(m3^2)+ 16*I2*I3*(L1^2)*m1 + 16*I1*I3*(L2^2)*m2 +64*I2*I3*(L1^2)*m2+ 16*I1*I2*(L3^2)*m3+64*I1*I3*(L2^2)*m3+64*I2*I3*(L1^2)*m3+4*I3*(L1^2)*(L2^2)*m1*m2+ 4*I2*(L1^2)*(L3^2)*m1*m3+16*I3*(L1^2)*(L2^2)*m1*m3+4*I1*(L2^2)*(L3^2)*m2*m3+ 16*I2*(L1^2)*(L3^2)*m2*m3 +48*I3*(L1^2)*(L2^2)*m2*m3 -8*I1*(L2^2)*(L3^2)*(m3^2)*cos(2*x2 -2*x3)- 2*(L1^2)*(L2^2)*cos(2*x1 -2*x2)*(m2 +2*m3)*(m2*m3*(L3^2) +4*I3*(m2+2*m3))- 2*(L1^2)*(L3^2)*(m3^2)*cos(2*x1-2*x3)*(4*I2-m2*(L2^2))+2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)+ 6*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2) + 2*(L1^2)*(L2^2)*(L3^2)*(m2^2)*m3 + (L1^2)*(L2^2)*(L3^2)*m1*m2*m3- 2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)*cos(2*x2 - 2*x3) - 4*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*cos(2*x2 - 2*x3));

    J = jacobian([f1,f2,f3,f4,f5,f6],[x1,x2,x3,x4,x5,x6]);
end