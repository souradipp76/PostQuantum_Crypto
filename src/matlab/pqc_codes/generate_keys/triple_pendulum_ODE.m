function y = triple_pendulum_ODE(deltaT, endT, ivp)

params = ivp(7:19);
m1=params(1);m2=params(2);m3=params(3);
L1=params(4);L2=params(5);L3=params(6);
I1=params(7);I2=params(8);I3=params(9);
k1=params(10);k2=params(11);k3=params(12);
g=params(13);

time = 0;
y = [ivp(1) ivp(2) ivp(3) ivp(4) ivp(5) ivp(6)];

x = zeros(6,1);
x(1) = ivp(1);
x(2) = ivp(2);
x(3) = ivp(3);
x(4) = ivp(4);
x(5) = ivp(5);
x(6) = ivp(6);

dtheta = zeros(3,1);

while(time < endT)

    %%acceleration at t
    dtheta(1) = -(2*(((L3^2)*(m3^2)*sin(2*x(1)-2*x(3))*(4*I2-(L2^2)*m2)+(L2^2)*sin(2*x(1)-2*x(2))*(m2 + 2*m3)*(m2*m3*(L3^2)+4*I3*(m2 + 2*m3)))*(L1^2)*(x(4)^2) +(L2*(sin(x(1)- x(2))*((m2*m3*(m2 + 3*m3)*(L3^2)+ 4*I3*((m2^2)+ 6*m2*m3 + 8*(m3^2)))*(L2^2)+4*I2*(m3*(m2 +m3)*(L3^2) + 4*I3*(m2 + 2*m3)))+(L3^2)*(m3^2)*sin(x(1) + x(2) -2*x(3))*(4*I2-(L2^2)*m2))*(x(5)^2)- 4*k2*L2*(cos(x(1)-x(2))*(m3*(m2 +m3)*(L3^2)+4*I3*(m2+2*m3))- (L3^2)*(m3^2)*cos(x(1)+x(2)-2*x(3)))*(x(5)^2)+ L3*m3*(sin(x(1)-x(3))*(8*I3*m3*(L2^2)+4*I2*m3*(L3^2)+16*I2*I3)+ (L2^2)*sin(x(1)-2*x(2) +x(3))*(m2*m3*(L3^2) +4*I3*(m2 +2*m3)))*(x(6)^2)- 4*k3*L3*m3*(cos(x(1)-x(3))*(2*m3*(L2^2) +4*I2)- (L2^2)*cos(x(1)-2*x(2) + x(3))*(m2 + 2*m3))*x(6)- g*(sin(x(1))*((m3*(m1*m2 + 2*m1*m3 + 3*m2*m3 + (m2^2))*(L3^2) + 4*I3*((m2^2)+ 6*m2*m3 + m1*m2 + 4*(m3^2)+ 4*m1*m3))*(L2^2)+ 4*I2*(m3*(m1 + 2*m2 + m3)*(L3^2) + 4*I3*(m1 + 2*m2 + 2*m3)))+ (L3^2)*(m3^2)*(sin(x(1)-2*x(3))*(4*I2-(L2^2)*m2)- 2*(L2^2)*cos(2*x(2)-2*x(3))*sin(x(1))*(m1 + m2))+ (L2^2)*sin(x(1)-2*x(2))*(m2 + 2*m3)*(m2*m3*(L3^2) +4*I3*(m2+2*m3))))*L1+ 2*k1*(4*I2*(m3*(L3^2) + 4*I3)+(L2^2)*(m3*(m2+2*m3)*(L3^2) + 4*I3*(m2+4*m3))-2*(L2^2)*(L3^2)*(m3^2)*cos(2*x(2)-2*x(3)))*x(1)))/(64*I1*I2*I3 +8*I3*(L1^2)*(L2^2)*(m2^2)+8*I1*(L2^2)*(L3^2)*(m3^2)+8*I2*(L1^2)*(L3^2)*(m3^2)+32*I3*(L1^2)*(L2^2)*(m3^2)+ 16*I2*I3*(L1^2)*m1 +16*I1*I3*(L2^2)*m2 +64*I2*I3*(L1^2)*m2+16*I1*I2*(L3^2)*m3+ 64*I1*I3*(L2^2)*m3 +64*I2*I3*(L1^2)*m3+4*I3*(L1^2)*(L2^2)*m1*m2+4*I2*(L1^2)*(L3^2)*m1*m3+ 16*I3*(L1^2)*(L2^2)*m1*m3+4*I1*(L2^2)*(L3^2)*m2*m3 +16*I2*(L1^2)*(L3^2)*m2*m3 +48*I3*(L1^2)*(L2^2)*m2*m3- 8*I1*(L2^2)*(L3^2)*(m3^2)*cos(2*x(2)-2*x(3))- 2*(L1^2)*(L2^2)*cos(2*x(1)-2*x(2))*(m2 +2*m3)*(m2*m3*(L3^2)+4*I3*(m2+2*m3))- 2*(L1^2)*(L3^2)*(m3^2)*cos(2*x(1)-2*x(3))*(-m2*(L2^2)+4*I2)+2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2) + 6*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2) + 2*(L1^2)*(L2^2)*(L3^2)*(m2^2)*m3+ (L1^2)*(L2^2)*(L3^2)*m1*m2*m3 - 2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)*cos(2*x(2)-2*x(3))- 4*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*cos(2*x(2)-2*x(3)));
    dtheta(2) = (2*(((L1^2)*sin(2*x(1) - 2*x(2))*(m2 + 2*m3)*(m2*m3*(L3^2) + 4*I3*(m2 + 2*m3))- (L3^2)*(m3^2)*sin(2*x(2) - 2*x(3))*((m1 +2*m2)*(L1^2) +4*I1))*(L2^2)*(x(5)^2) + L1*(sin(x(1) -x(2))*((m3*(m1*(m2 +m3)+2*m2*(2*m2 +3*m3))*(L3^2)+4*I3*(m2 +2*m3)*(m1 +4*m2 + 4*m3))*(L1^2) + 4*I1*(m3*(m2 + m3)*(L3^2) + 4*I3*(m2 + 2*m3)))-(L3^2)*(m3^2)*sin(x(1) + x(2) - 2*x(3))*((m1 + 2*m2)*(L1^2) + 4*I1))*L2*(x(4)^2)+4*k1*L1*(cos(x(1) - x(2))*(m3*(m2 + m3)*(L3^2) + 4*I3*(m2 + 2*m3))-(L3^2)*(m3^2)*cos(x(1) + x(2) - 2*x(3)))*L2*x(4) +(-L3*m3*(sin(x(2)-x(3))*((m3*(m1+3*m2)*(L3^2)+ 4*I3*(m1+3*m2+2*m3))*(L1^2)+4*I1*(m3*(L3^2)+4*I3))-(L1^2)*sin(2*x(1)-x(2)-x(3))*(m2*m3*(L3^2) +4*I3*(m2 +2*m3)))*(x(6)^2)+ 4*k3*L3*m3*(cos(x(2) -x(3))*((m1 +3*m2 +2*m3)*(L1^2) +4*I1)- (L1^2)*cos(2*x(1) -x(2)-x(3))*(m2+2*m3))*x(6)+ g*(sin(x(2))*((m2*m3*(2*m2+3*m3)*(L3^2)+ 8*I3*((m2^2)+3*m2*m3+2*(m3^2)))*(L1^2) + 4*I1*(m3*(m2+m3)*(L3^2) +4*I3*(m2 + 2*m3)))- (L1^2)*sin(2*x(1) - x(2))*(m3*(m1*(m2 + m3) + m2*(2*m2 + 3*m3))*(L3^2)+ 4*I3*(m2 +2*m3)*(m1 + 2*m2 + 2*m3)) + (L3^2)*(m3^2)*(sin(x(2) - 2*x(3))*(m2*(L1^2) + 4*I1)+ (L1^2)*sin(2*x(1) + x(2) - 2*x(3))*(m1 +m2))))*L2- 2*k2*(4*I1*(m3*(L3^2) + 4*I3) + (L1^2)*(m3*(m1 + 4*m2 + 2*m3)*(L3^2)+ 4*I3*(m1 + 4*m2 + 4*m3)) - 2*(L1^2)*(L3^2)*(m3^2)*cos(2*x(1) -2*x(3)))*(x(5)^2)))/(64*I1*I2*I3 +8*I3*(L1^2)*(L2^2)*(m2^2)+8*I1*(L2^2)*(L3^2)*(m3^2)+8*I2*(L1^2)*(L3^2)*(m3^2)+32*I3*(L1^2)*(L2^2)*(m3^2)+16*I2*I3*(L1^2)*m1 + 16*I1*I3*(L2^2)*m2 +64*I2*I3*(L1^2)*m2+ 16*I1*I2*(L3^2)*m3+64*I1*I3*(L2^2)*m3+64*I2*I3*(L1^2)*m3+4*I3*(L1^2)*(L2^2)*m1*m2+ 4*I2*(L1^2)*(L3^2)*m1*m3+16*I3*(L1^2)*(L2^2)*m1*m3+4*I1*(L2^2)*(L3^2)*m2*m3+ 16*I2*(L1^2)*(L3^2)*m2*m3 +48*I3*(L1^2)*(L2^2)*m2*m3 -8*I1*(L2^2)*(L3^2)*(m3^2)*cos(2*x(2) -2*x(3))- 2*(L1^2)*(L2^2)*cos(2*x(1) -2*x(2))*(m2 +2*m3)*(m2*m3*(L3^2)+4*I3*(m2+2*m3))- 2*(L1^2)*(L3^2)*(m3^2)*cos(2*x(1)-2*x(3))*(-m2*(L2^2)+4*I2)+2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)+ 6*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)+2*(L1^2)*(L2^2)*(L3^2)*(m2^2)*m3 + (L1^2)*(L2^2)*(L3^2)*m1*m2*m3- 2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)*cos(2*x(2) - 2*x(3)) - 4*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*cos(2*x(2) - 2*x(3)));
    dtheta(3) = -(2*(32*I1*I2*k3*x(6) - L2*L3*m3*(x(5)^2)*(sin(x(2) - x(3))*(((L2^2)*(m1*m2 + 4*m1*m3 + 6*m2*m3 + (m2^2))+ 4*I2*(m1 +3*m2 + 2*m3))*(L1^2) + 4*I1*(4*I2 + (L2^2)*(m2 + 4*m3)))+ (L1^2)*sin(2*x(1) - x(2) - x(3))*(m2 + 2*m3)*(4*I2 - m2*(L2^2)))- L1*L3*m3*(x(4)^2)*(sin(x(1) -x(3))*(8*I1*(m3*(L2^2) +2*I2)+2*(L1^2)*((m1*m3 -(m2^2))*(L2^2)+ 2*I2*(m1 +4*m2 +4*m3)))- (L2^2)*sin(x(1) -2*x(2) + x(3))*(m2 + 2*m3)*((m1 + 2*m2)*(L1^2) + 4*I1))+ 4*k3*(L1^2)*(L2^2)*(m2^2)*x(6) + 16*k3*(L1^2)*(L2^2)*(m3^2)*x(6) + 8*I2*k3*(L1^2)*m1*x(6)+ 8*I1*k3*(L2^2)*m2*x(6) + 32*I2*k3*(L1^2)*m2*x(6) + 32*I1*k3*(L2^2)*m3*x(6)+ 32*I2*k3*(L1^2)*m3*x(6) - 4*k1*L1*L3*m3*x(4)*(cos(x(1) - x(3))*(2*m3*(L2^2) +4*I2)- (L2^2)*cos(x(1) - 2*x(2) + x(3))*(m2 + 2*m3)) - 16*I1*I2*g*L3*m3*sin(x(3))- 4*I2*(L1^2)*(L3^2)*(m3^2)*(x(6)^2)*sin(2*x(1) - 2*x(3)) -4*I1*(L2^2)*(L3^2)*(m3^2)*(x(6)^2)*sin(2*x(2) -2*x(3))+ 8*I2*g*(L1^2)*L3*(m3^2)*sin(2*x(1) -x(3))+8*I1*g*(L2^2)*L3*(m3^2)*sin(2*x(2) -x(3))+ 2*k3*(L1^2)*(L2^2)*m1*m2*x(6) + 8*k3*(L1^2)*(L2^2)*m1*m3*x(6) + 24*k3*(L1^2)*(L2^2)*m2*m3*x(6)- 4*k2*L2*L3*m3*x(5)*(cos(x(2) - x(3))*((m1 + 3*m2 + 2*m3)*(L1^2) + 4*I1)- (L1^2)*cos(2*x(1) - x(2) - x(3))*(m2 + 2*m3)) - 8*I1*g*(L2^2)*L3*(m3^2)*sin(x(3))- 8*I2*g*(L1^2)*L3*(m3^2)*sin(x(3)) - 4*k3*(L1^2)*(L2^2)*(m2^2)*x(6)*cos(2*x(1) -2*x(2))- 16*k3*(L1^2)*(L2^2)*(m3^2)*x(6)*cos(2*x(1) - 2*x(2)) - 8*I2*g*(L1^2)*L3*m2*m3*sin(x(3))- 16*k3*(L1^2)*(L2^2)*m2*m3*x(6)*cos(2*x(1) - 2*x(2)) -(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)*(x(6)^2)*sin(2*x(2) - 2*x(3))+ (L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*(x(6)^2)*sin(2*x(1) - 2*x(3)) - 2*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*(x(6)^2)*sin(2*x(2) -2*x(3))+ 2*g*(L1^2)*(L2^2)*L3*m1*(m3^2)*sin(2*x(1) - x(3)) - g*(L1^2)*(L2^2)*L3*(m2^2)*m3*sin(2*x(1) - x(3))+ 2*g*(L1^2)*(L2^2)*L3*m2*(m3^2)*sin(2*x(2) -x(3)) + g*(L1^2)*(L2^2)*L3*(m2^2)*m3*sin(2*x(2) - x(3))+ 4*I2*g*(L1^2)*L3*m1*m3*sin(2*x(1) - x(3)) + 8*I2*g*(L1^2)*L3*m2*m3*sin(2*x(1) - x(3))+ 4*I1*g*(L2^2)*L3*m2*m3*sin(2*x(2) - x(3)) - 2*g*(L1^2)*(L2^2)*L3*m1*(m3^2)*sin(2*x(1) - 2*x(2) + x(3))- 2*g*(L1^2)*(L2^2)*L3*m2*(m3^2)*sin(2*x(1) - 2*x(2) +x(3)) - g*(L1^2)*(L2^2)*L3*(m2^2)*m3*sin(2*x(1) - 2*x(2) + x(3))+ g*(L1^2)*(L2^2)*L3*(m2^2)*m3*sin(x(3)) - g*(L1^2)*(L2^2)*L3*m1*m2*m3*sin(2*x(1) - 2*x(2) +x(3))))/(64*I1*I2*I3 + 8*I3*(L1^2)*(L2^2)*(m2^2)+ 8*I1*(L2^2)*(L3^2)*(m3^2)*+ 8*I2*(L1^2)*(L3^2)*(m3^2)+ 32*I3*(L1^2)*(L2^2)*(m3^2)+ 16*I2*I3*(L1^2)*m1 + 16*I1*I3*(L2^2)*m2 +64*I2*I3*(L1^2)*m2+ 16*I1*I2*(L3^2)*m3+64*I1*I3*(L2^2)*m3+64*I2*I3*(L1^2)*m3+4*I3*(L1^2)*(L2^2)*m1*m2+ 4*I2*(L1^2)*(L3^2)*m1*m3+16*I3*(L1^2)*(L2^2)*m1*m3+4*I1*(L2^2)*(L3^2)*m2*m3+ 16*I2*(L1^2)*(L3^2)*m2*m3 +48*I3*(L1^2)*(L2^2)*m2*m3 -8*I1*(L2^2)*(L3^2)*(m3^2)*cos(2*x(2) -2*x(3))- 2*(L1^2)*(L2^2)*cos(2*x(1) -2*x(2))*(m2 +2*m3)*(m2*m3*(L3^2) +4*I3*(m2+2*m3))- 2*(L1^2)*(L3^2)*(m3^2)*cos(2*x(1)-2*x(3))*(4*I2-m2*(L2^2))+2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)+ 6*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2) + 2*(L1^2)*(L2^2)*(L3^2)*(m2^2)*m3 + (L1^2)*(L2^2)*(L3^2)*m1*m2*m3- 2*(L1^2)*(L2^2)*(L3^2)*m1*(m3^2)*cos(2*x(2) - 2*x(3)) - 4*(L1^2)*(L2^2)*(L3^2)*m2*(m3^2)*cos(2*x(2) - 2*x(3)));

    %%position at t+deltaT    
    x(1) = x(1) + (x(4)*deltaT);
    x(2) = x(2) + (x(5)*deltaT);
    x(3) = x(3) + (x(6)*deltaT);
    
    %%velocity at t+deltaT
    x(4) = x(4) + (dtheta(1)*deltaT);
    x(5) = x(5) + (dtheta(2)*deltaT);
    x(6) = x(6) + (dtheta(3)*deltaT);

    y = [y; x(1) x(2) x(3) x(4) x(5) x(6)];
    time = time + deltaT;
end
end